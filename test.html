<html>
  <head>
    <meta charset="utf-8" />
  </head>
  <body>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/pyodide/v0.23.0/full/pyodide.js"></script>
    <script type="text/javascript">
      async function main() {
        let pyodide = await loadPyodide();
        await pyodide.loadPackage("micropip");
        const micropip = pyodide.pyimport("micropip");
        await micropip.install("boto3");
        await pyodide.runPython(`
        import boto3
        
        print(f"suceuss")
      `);
      }
      main();
    </script>
  </body>
</html>

#import micropip
#await pyodide.loadPackage("micropip")
#micropip = pyodide.pyimport("micropip")
#await micropip.install("boto3")
#import boto3

#s3 = boto3.resource('s3', aws_access_key_id='AKIA5PDTUHUEBBGAN24X',aws_secret_access_key='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')
#bucket_name = "nyucapstone-images"
#image_name = filename + '.png'
#s3.Bucket(bucket_name).upload_file(image_name, image_name)
#print(f"file is uploaded to bucket successfully")




// Initialize the Amazon Cognito credentials provider
AWS.config.region = 'us-east-2'; // Region
AWS.config.credentials = new AWS.CognitoIdentityCredentials({
    IdentityPoolId: 'us-east-2:1913b386-4748-4dbd-b7b4-74f0bbb2e181',
});



//    console.log("HELLLLLOOOO")

//         function addPhoto(albumName) {
//             var albumBucketName = "nyucapstone-images";
//             var bucketRegion = "us-east-2";
//             var IdentityPoolId = "us-east-2:1913b386-4748-4dbd-b7b4-74f0bbb2e181";

//             AWS.config.update({
//             region: bucketRegion,
//             credentials: new AWS.CognitoIdentityCredentials({
//                 IdentityPoolId: IdentityPoolId
//             })
//             });

//             // Create a new service object
//                 var s3 = new AWS.S3({
//                 apiVersion: '2006-03-01',
//                 params: {Bucket: albumBucketName}
//                 });
//             // var files = document.getElementById("photoupload").files;
//             // if (!files.length) {
//             //     return alert("Please choose a file to upload first.");
//             // }
//             // var file = files[0];
//             // var fileName = file.name;
//             var albumPhotosKey = encodeURIComponent(albumName) + "/";

//             var photoKey = albumPhotosKey + "test.txt";

//             // Use S3 ManagedUpload class as it supports multipart uploads
//             var upload = new AWS.S3.ManagedUpload({
//                 params: {
//                 Bucket: albumBucketName,
//                 Key: photoKey,
//                 Body: "hello world"
//                 }
//             });

//             var promise = upload.promise();

//             promise.then(
//                 function(data) {
//                 alert("Successfully uploaded photo.");
//                 },
//                 function(err) {
//                 return alert("There was an error uploading your photo: ", err.message);
//                 }
//             );
//             }



function uploadfiletoaws(albumName) { 
  var albumBucketName = "nyucapstone-images";
      var bucketRegion = "us-east-2";
      var IdentityPoolId = "us-east-2:1913b386-4748-4dbd-b7b4-74f0bbb2e181";

      AWS.config.update({
      region: bucketRegion,
      credentials: new AWS.CognitoIdentityCredentials({
          IdentityPoolId: IdentityPoolId
      })
      });

      var s3 = new AWS.S3({
          apiVersion: '2006-03-01',
          params: {Bucket: albumBucketName}
      });
   }








// function uploadfiletoaws(albumName) {


  //     AWS.config.region = 'us-east-2'
  //     const credentials = new AWS.CognitoIdentityCredentials({
  //         IdentityPoolId: 'us-east-2:1913b386-4748-4dbd-b7b4-74f0bbb2e181',
  //     })
  //     const locationClient = new AWS.Location({
  //         credentials,
  //     })
     
  // }




  # import requests

  # def draw_latest_image_from_firebase(self, database_url):
  #     # Fetch the latest image URL from Firebase
  #     image_url, image_name = get_latest_image_url(database_url)

  #     # Fetch the image from the URL
  #     response = requests.get(image_url)
  #     image = Image.open(io.BytesIO(response.content))

  #     # Convert the image to a NumPy array
  #     image_array = np.array(image)

  #     # Draw the image on the canvas using the CanvasProxy class
  #     self.canvas[0].put_image_data(image_array, x, y)  # Replace x and y with desired coordinates
      
  #     return image_url, image_name



  # inf_canvas = InfCanvas(...)
# database_url = 'https://nyucapstone-7c22c-default-rtdb.firebaseio.com'
# latest_image_url, latest_image_name = inf_canvas.draw_latest_image_from_firebase(database_url)
# print(f"Latest image URL: {latest_image_url}")






# async def fetch_latest_image_url(database_url):
#     response = await pyfetch(f"{database_url}/latestImage.json")
#     latest_image_data = await response.json()
#     image_url = latest_image_data['downloadURL']
#     image_name = latest_image_data['fileName']
#     return image_url, image_name

# async def main():
#     database_url = 'https://nyucapstone-7c22c-default-rtdb.firebaseio.com'
#     latest_image_url, latest_image_name = await fetch_latest_image_url(database_url)
#     print(f"Latest image URL: {latest_image_url}")
#     print(f"Latest image name: {latest_image_name}")

# # Call the main function
# import asyncio
# asyncio.run(main())



app.py CALL FROM FIREBASE WORKING FUNCTION

# import requests

# def get_latest_image_url(database_url):
#     response = requests.get(f"{database_url}/latestImage.json")
#     latest_image_data = response.json()
#     image_url = latest_image_data['downloadURL']
#     image_name = latest_image_data['fileName']
#     return image_url, image_name

# database_url = 'https://nyucapstone-7c22c-default-rtdb.firebaseio.com'
# latest_image_url, latest_image_name = get_latest_image_url(database_url)
# print(f"Latest image URL: {latest_image_url}")
# print(f"Latest image name: {latest_image_name}")